# https://moonrepo.dev/docs/config/project
$schema: 'https://moonrepo.dev/schemas/project.json'

type: 'application'
language: 'typescript'
stack: 'frontend'
tags:
  - 'next'
  - 'react'

fileGroups:
  sources:
    - 'src/**/*'
  assets:
    - 'public/**/*'
  configs:
    - 'next.config.js'
    - 'tsconfig.json'
    - 'tailwind.config.js'
    - 'postcss.config.js'
  package:
    - 'package.json'
    - 'bun.lock'

tasks:
  install:
    command: 'bun'
    args: 'install'
    inputs:
      - '@group(package)'
    outputs:
      - 'node_modules'

  dev:
    command: 'bunx'
    args: 'next dev'
    deps:
      - '~:install'
    local: true
    options:
      persistent: true

  build:
    command: 'bunx'
    args: 'next build'
    deps:
      - '~:install'
    inputs:
      - '@group(sources)'
      - '@group(assets)'
      - '@group(configs)'
    outputs:
      - '.next'

  lint:
    command: 'bunx'
    args: 'next lint'
    deps:
      - '~:install'
    inputs:
      - '@group(sources)'
      - '@group(configs)'

  typecheck:
    command: 'bunx'
    args: 'tsc --noEmit'
    deps:
      - '~:install'
    inputs:
      - '@group(sources)'
      - 'tsconfig.json'
